<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SCG AI Training Survey - Executive Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--red:#C8102E;--dark-red:#A00D24;--dark:#2D2D2D;--gray:#666;--light:#E8E8E8;--bg:#F5F5F5;--green:#28a745;--orange:#FF9800;--blue:#2196F3;--purple:#7B1FA2}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Prompt',sans-serif;background:var(--bg);color:var(--dark);font-size:14px;line-height:1.5}
.container{max-width:1400px;margin:0 auto;padding:20px}
.header{background:linear-gradient(135deg,var(--red),var(--dark-red));color:#fff;padding:24px;border-radius:16px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px}
.header h1{font-size:1.4rem}.header p{opacity:.9;font-size:.85rem}
.header-stats{display:flex;gap:30px}
.header-stat{text-align:center}
.header-stat-value{font-size:1.8rem;font-weight:700}
.header-stat-label{font-size:.75rem;opacity:.85}
.filter-bar{background:#fff;padding:15px 20px;border-radius:12px;margin-bottom:20px;display:flex;gap:15px;flex-wrap:wrap;align-items:center;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.filter-group{display:flex;align-items:center;gap:8px}
.filter-group label{font-weight:500;font-size:.85rem;color:var(--gray)}
select,input[type=text]{padding:8px 12px;border:2px solid var(--light);border-radius:8px;font-family:inherit;font-size:.85rem}
select:focus,input:focus{outline:none;border-color:var(--red)}
.btn{padding:8px 16px;background:var(--red);color:#fff;border:none;border-radius:8px;font-family:inherit;font-size:.85rem;font-weight:500;cursor:pointer}
.btn:hover{background:var(--dark-red)}
.btn.sec{background:var(--light);color:var(--dark)}
.btn.green{background:var(--green)}
.kpi-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px;margin-bottom:20px}
.kpi{background:#fff;padding:18px;border-radius:12px;text-align:center;border-left:4px solid var(--red);box-shadow:0 2px 8px rgba(0,0,0,.06)}
.kpi.green{border-left-color:var(--green)}.kpi.blue{border-left-color:var(--blue)}.kpi.orange{border-left-color:var(--orange)}
.kpi-value{font-size:1.6rem;font-weight:700}
.kpi-label{font-size:.8rem;color:var(--gray);margin-top:4px}
.kpi-hint{font-size:.7rem;margin-top:6px;padding:2px 8px;border-radius:12px;display:inline-block;background:#E8F5E9;color:var(--green)}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
.card{background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.06);overflow:hidden}
.card.full{grid-column:1/-1}
.card-header{padding:14px 18px;border-bottom:1px solid var(--light);display:flex;align-items:center;gap:10px}
.card-badge{width:28px;height:28px;background:var(--red);color:#fff;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.8rem}
.card-title h3{font-size:.9rem;font-weight:600}
.card-title p{font-size:.7rem;color:var(--gray)}
.card-body{padding:18px}
.level-bars{display:flex;flex-direction:column;gap:8px}
.level-item{display:flex;align-items:center;gap:10px}
.level-badge{width:32px;height:32px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.75rem}
.l0{background:#E0E0E0}.l1{background:#FFCDD2}.l2{background:#FFAB91}.l3{background:#FFE082}.l4{background:#A5D6A7}.l5{background:#4CAF50;color:#fff}
.level-info{flex:1}
.level-top{display:flex;justify-content:space-between;font-size:.75rem;margin-bottom:3px}
.level-count{font-weight:600;color:var(--red)}
.level-track{height:6px;background:var(--light);border-radius:3px;overflow:hidden}
.level-fill{height:100%;border-radius:3px}
.tool-grid{display:flex;flex-wrap:wrap;gap:6px}
.tool-chip{padding:5px 10px;background:var(--bg);border-radius:12px;font-size:.72rem;display:flex;align-items:center;gap:4px}
.tool-chip .cnt{background:var(--red);color:#fff;padding:1px 5px;border-radius:6px;font-size:.6rem;font-weight:600}
.tool-section{margin-bottom:10px}
.tool-label{font-size:.7rem;color:var(--gray);margin-bottom:5px;font-weight:500}
.freq-chart{display:flex;align-items:flex-end;justify-content:space-around;height:140px;padding-top:20px}
.freq-wrap{display:flex;flex-direction:column;align-items:center;gap:5px}
.freq-bar{width:36px;background:linear-gradient(to top,var(--red),var(--dark-red));border-radius:4px 4px 0 0;position:relative}
.freq-val{position:absolute;top:-18px;left:50%;transform:translateX(-50%);font-size:.7rem;font-weight:600}
.freq-lbl{font-size:.6rem;color:var(--gray);text-align:center;max-width:55px}
.heatmap{width:100%;border-collapse:collapse}
.heatmap th,.heatmap td{padding:8px;text-align:center;font-size:.75rem}
.heatmap th{background:var(--bg);font-weight:500;color:var(--gray)}
.heatmap th:first-child,.heatmap td:first-child{text-align:left}
.heat{padding:4px 8px;border-radius:4px;font-weight:600;display:inline-block;min-width:30px}
.h0{background:#ECEFF1;color:#78909C}.h1{background:#FFCDD2;color:#C62828}.h2{background:#FFE0B2;color:#EF6C00}.h3{background:#FFF9C4;color:#F9A825}.h4{background:#C8E6C9;color:#2E7D32}
.team-compare{display:grid;grid-template-columns:1fr 1fr;gap:15px}
@media(max-width:700px){.team-compare{grid-template-columns:1fr}}
.team-col{padding:12px;border-radius:8px}
.team-col.trans{background:#E3F2FD}.team-col.green{background:#E8F5E9}.team-col.other{background:#F3E5F5}
.team-col h5{font-size:.8rem;margin-bottom:8px;padding-bottom:6px;border-bottom:2px solid rgba(0,0,0,.1)}
.work-list{display:flex;flex-direction:column;gap:6px}
.work-item{display:flex;align-items:center;gap:8px}
.work-rank{width:20px;height:20px;background:var(--red);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:600}
.work-info{flex:1}
.work-name{font-size:.7rem;margin-bottom:2px}
.work-track{height:4px;background:var(--light);border-radius:2px;overflow:hidden}
.work-fill{height:100%;background:var(--red)}
.work-pct{font-size:.75rem;font-weight:700;color:var(--red);min-width:35px;text-align:right}
.problem-list{display:flex;flex-direction:column;gap:6px}
.problem-item{display:flex;align-items:center;gap:8px;padding:8px;background:var(--bg);border-radius:6px}
.problem-icon{width:26px;height:26px;background:#FFEBEE;color:var(--red);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.8rem}
.problem-name{flex:1;font-size:.75rem}
.problem-cnt{font-size:.9rem;font-weight:700;color:var(--red)}
.theme-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:6px}
.theme-card{padding:8px;background:var(--bg);border-radius:6px;display:flex;align-items:center;gap:6px}
.theme-icon{width:28px;height:28px;background:#fff;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.9rem}
.theme-name{font-size:.7rem;font-weight:500}
.theme-votes{font-size:.6rem;color:var(--gray)}
.matrix{position:relative;width:100%;height:280px;background:linear-gradient(to right,#E8F5E9 50%,#FFF3E0 50%);border-radius:8px;overflow:hidden}
.matrix::before{content:'';position:absolute;top:50%;left:0;right:0;height:1px;background:rgba(0,0,0,.1)}
.matrix::after{content:'';position:absolute;left:50%;top:0;bottom:0;width:1px;background:rgba(0,0,0,.1)}
.quad{position:absolute;font-size:.6rem;font-weight:600;color:var(--gray);opacity:.7}
.quad.tl{top:6px;left:6px}.quad.tr{top:6px;right:6px;text-align:right}.quad.bl{bottom:6px;left:6px}.quad.br{bottom:6px;right:6px;text-align:right}
.bubble{position:absolute;padding:4px 8px;background:#fff;border-radius:12px;font-size:.6rem;box-shadow:0 2px 5px rgba(0,0,0,.15);cursor:pointer;white-space:nowrap}
.bubble:hover{transform:scale(1.1);z-index:10}
.bubble .v{background:var(--red);color:#fff;padding:1px 4px;border-radius:4px;font-size:.5rem;margin-left:2px}
.rating-table{width:100%;border-collapse:collapse}
.rating-table th,.rating-table td{padding:8px;text-align:left;border-bottom:1px solid var(--light);font-size:.75rem}
.rating-table th{font-weight:500;color:var(--gray);font-size:.7rem}
.rating-wrap{display:flex;align-items:center;gap:6px}
.rating-bar{flex:1;height:6px;background:var(--light);border-radius:3px;overflow:hidden;max-width:80px}
.rating-fill{height:100%;background:var(--red)}
.rating-score{font-weight:700;color:var(--red);min-width:24px}
.ideas-list{display:flex;flex-direction:column;gap:8px;max-height:300px;overflow-y:auto}
.idea-card{padding:10px;background:var(--bg);border-radius:8px;border-left:3px solid var(--red)}
.idea-header{display:flex;justify-content:space-between;margin-bottom:4px}
.idea-badge{padding:2px 6px;border-radius:8px;font-size:.55rem;font-weight:600}
.idea-badge.trans{background:#E3F2FD;color:#1565C0}.idea-badge.green{background:#E8F5E9;color:#2E7D32}.idea-badge.other{background:#F3E5F5;color:#7B1FA2}
.idea-text{font-size:.75rem}
.insight-panel{background:linear-gradient(135deg,#FFF3E0,#FFE0B2);border-radius:12px;padding:18px;margin-top:20px}
.insight-panel h4{display:flex;align-items:center;gap:8px;font-size:.9rem;margin-bottom:12px}
.insight-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:8px}
.insight-item{padding:10px;background:#fff;border-radius:6px;font-size:.75rem;display:flex;gap:8px}
.insight-icon{font-size:1rem}
.rec-panel{background:linear-gradient(135deg,#E3F2FD,#BBDEFB);border-radius:12px;padding:18px;margin-top:20px}
.rec-panel h4{display:flex;align-items:center;gap:8px;font-size:.9rem;margin-bottom:12px}
.rec-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.rec-card{background:#fff;padding:12px;border-radius:8px}
.rec-card h5{font-size:.8rem;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.rec-card ul{list-style:none}
.rec-card li{padding:3px 0 3px 14px;font-size:.7rem;position:relative}
.rec-card li::before{content:"‚Üí";position:absolute;left:0;color:var(--red)}
.import-panel{background:#fff;border-radius:12px;padding:18px;margin-top:20px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.import-panel h4{font-size:.9rem;margin-bottom:12px}
.import-area{display:grid;grid-template-columns:1fr auto;gap:12px}
@media(max-width:600px){.import-area{grid-template-columns:1fr}}
textarea{width:100%;min-height:80px;padding:10px;border:2px dashed var(--light);border-radius:6px;font-family:monospace;font-size:.65rem;resize:vertical}
textarea:focus{outline:none;border-color:var(--red)}
.import-btns{display:flex;flex-direction:column;gap:6px}
details{margin-top:12px}
summary{cursor:pointer;font-weight:500;font-size:.75rem;color:var(--gray)}
pre{margin-top:8px;padding:10px;background:var(--dark);color:#E0E0E0;border-radius:6px;font-size:.6rem;overflow-x:auto}
.footer{text-align:center;padding:20px;color:var(--gray);font-size:.7rem;margin-top:20px}
.toast{position:fixed;bottom:20px;right:20px;padding:10px 18px;background:var(--dark);color:#fff;border-radius:6px;font-size:.8rem;box-shadow:0 4px 12px rgba(0,0,0,.2);z-index:1000;display:none}
.toast.success{background:var(--green)}.toast.error{background:var(--red)}
.toast.show{display:block;animation:fadeIn .3s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.status-bar{background:#fff;padding:12px 20px;border-radius:12px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.status-item{display:flex;align-items:center;gap:8px;font-size:.85rem}
.status-dot{width:10px;height:10px;border-radius:50%;background:#ccc}
.status-dot.online{background:var(--green);animation:pulse 2s infinite}
.status-dot.loading{background:var(--orange);animation:pulse 1s infinite}
.status-dot.error{background:var(--red)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
</style>
</head>
<body>
<div class="toast" id="toast"></div>
<div class="container">
<header class="header">
<div><h1>üìä SCG AI Training Survey Dashboard</h1><p>Executive View ‚Ä¢ Cement & Green Solutions</p></div>
<div class="header-stats">
<div class="header-stat"><div class="header-stat-value" id="totalCount">0</div><div class="header-stat-label">‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div>
<div class="header-stat"><div class="header-stat-value" id="transCount">0</div><div class="header-stat-label">Transformers</div></div>
<div class="header-stat"><div class="header-stat-value" id="greenCount">0</div><div class="header-stat-label">Green Circularity</div></div>
<div class="header-stat"><div class="header-stat-value" id="otherCount">0</div><div class="header-stat-label">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</div></div>
</div>
</header>

<!-- Status Bar for Google Sheets Connection -->
<div class="status-bar" id="statusBar">
<div class="status-item"><div class="status-dot" id="statusDot"></div><span id="statusText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
<div class="status-item"><span id="lastUpdate">-</span></div>
<div style="display:flex;gap:8px;">
<button class="btn" onclick="fetchFromGoogleSheets()">üîÑ Refresh</button>
</div>
</div>

<div class="filter-bar">
<div class="filter-group"><label>‡∏ó‡∏µ‡∏°:</label><select id="teamFilter" onchange="render()"><option value="all">‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡∏°</option><option value="transformers">Transformers</option><option value="green">Green Circularity</option><option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option></select></div>
<div class="filter-group"><label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</label><input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="render()"></div>
<button class="btn sec" onclick="resetFilters()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
<button class="btn" onclick="exportData()">üì• Export</button>
</div>
<div class="kpi-row">
<div class="kpi"><div class="kpi-value" id="kpiLevel">0</div><div class="kpi-label">Avg AI Readiness</div><div class="kpi-hint" id="kpiLevelHint">-</div></div>
<div class="kpi green"><div class="kpi-value" id="kpiDaily">0%</div><div class="kpi-label">‡πÉ‡∏ä‡πâ AI ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</div><div class="kpi-hint">Active</div></div>
<div class="kpi blue"><div class="kpi-value" id="kpiTool">-</div><div class="kpi-label">Tool ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</div><div class="kpi-hint" id="kpiToolPct">-</div></div>
<div class="kpi orange"><div class="kpi-value" id="kpiPain">0</div><div class="kpi-label">Pain Points</div><div class="kpi-hint" style="background:#FFEBEE;color:var(--red)">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</div></div>
<div class="kpi"><div class="kpi-value" id="kpiExpect">0</div><div class="kpi-label">‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</div><div class="kpi-hint">‡∏™‡∏π‡∏á</div></div>
</div>
<div class="grid">
<div class="card"><div class="card-header"><div class="card-badge">A</div><div class="card-title"><h3>Respondent Snapshot</h3><p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö</p></div></div><div class="card-body"><div class="team-compare" id="respondentSnapshot"></div></div></div>
<div class="card"><div class="card-header"><div class="card-badge">B1</div><div class="card-title"><h3>AI Readiness Level</h3><p>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°</p></div></div><div class="card-body"><div class="level-bars" id="levelDist"></div></div></div>
<div class="card"><div class="card-header"><div class="card-badge">B2</div><div class="card-title"><h3>AI Tools</h3><p>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</p></div></div><div class="card-body" id="toolsAdoption"></div></div>
<div class="card"><div class="card-header"><div class="card-badge">B3</div><div class="card-title"><h3>Frequency</h3><p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà</p></div></div><div class="card-body"><div class="freq-chart" id="freqChart"></div></div></div>
<div class="card full"><div class="card-header"><div class="card-badge">B4</div><div class="card-title"><h3>Copilot Satisfaction</h3><p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</p></div></div><div class="card-body"><table class="heatmap" id="copilotHeat"></table></div></div>
<div class="card full"><div class="card-header"><div class="card-badge">C</div><div class="card-title"><h3>Time Allocation</h3><p>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</p></div></div><div class="card-body"><div class="team-compare" id="workAllocation"></div></div></div>
<div class="card"><div class="card-header"><div class="card-badge">D1</div><div class="card-title"><h3>Problems</h3><p>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</p></div></div><div class="card-body"><div class="problem-list" id="problemList"></div></div></div>
<div class="card"><div class="card-header"><div class="card-badge">D2</div><div class="card-title"><h3>AI Help</h3><p>‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢</p></div></div><div class="card-body"><div class="theme-grid" id="aiHelpThemes"></div></div></div>
<div class="card full"><div class="card-header"><div class="card-badge">D3</div><div class="card-title"><h3>Features Matrix</h3><p>Impact √ó Effort</p></div></div><div class="card-body"><div class="matrix" id="featureMatrix"><div class="quad tl">‚ö° Quick Wins</div><div class="quad tr">üéØ Strategic</div><div class="quad bl">üîß Fill-ins</div><div class="quad br">‚ùì Reconsider</div></div></div></div>
<div class="card"><div class="card-header"><div class="card-badge">E1</div><div class="card-title"><h3>Expectations</h3><p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</p></div></div><div class="card-body"><table class="rating-table" id="expectTable"></table></div></div>
<div class="card"><div class="card-header"><div class="card-badge">E2</div><div class="card-title"><h3>Topics</h3><p>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</p></div></div><div class="card-body"><div class="theme-grid" id="topicsGrid"></div></div></div>
<div class="card full"><div class="card-header"><div class="card-badge">F</div><div class="card-title"><h3>Ideas & Notes</h3><p>‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢</p></div></div><div class="card-body"><div class="ideas-list" id="ideasList"></div></div></div>
</div>
<div class="insight-panel"><h4>üí° Key Insights</h4><div class="insight-list" id="insightList"></div></div>
<div class="rec-panel"><h4>üéØ Training Plan</h4><div class="rec-cards" id="recCards"></div></div>
<div class="import-panel"><h4>üì• Data Import</h4><div class="import-area"><textarea id="importArea" placeholder="‡∏ß‡∏≤‡∏á JSON..."></textarea><div class="import-btns"><button class="btn" onclick="importData()">Import</button><button class="btn sec" onclick="exportData()">Export</button></div></div><details><summary>üìã Schema</summary><pre id="schemaDisplay"></pre></details></div>
<footer class="footer"><strong>SCG AI Training Dashboard</strong> ‚Ä¢ <strong>Innovate AI</strong> ‚Ä¢ v2.0 (Google Sheets Connected)</footer>
</div>
<script>
// ===== CONFIG =====
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz9Xog9TGGte1fu5HC4ajzx_uvTAOTE2nTedMw_pWnzyjCllb0hujDHcmr6fEE6vQdyLw/exec';

// ===== DATA (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ - ‡∏£‡∏≠‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Google Sheets) =====
let DATA = { respondents: [] };
const SCHEMA=`{respondents:[{team,teamOtherName,name,position,department,readinessLevel(0-5),toolsUsed[],usageFrequency,copilotSatisfaction{word,excel,ppt,teams},workAllocation[{activity,percent}],problems[],aiHelpMost[],interestedFeatures[],expectationsScore{reduceRepeat,increaseEfficiency,fasterAccess,betterTeamwork,applyImmediately,learnNewTech,prepareFuture,createInnovation},interestedTopics[],ideas,speakerNotes}]}`;

// ===== GOOGLE SHEETS FETCH =====
async function fetchFromGoogleSheets() {
    updateStatus('loading');
    try {
        const response = await fetch(GOOGLE_SCRIPT_URL);
        const json = await response.json();
        
        if (json.respondents && json.respondents.length > 0) {
            DATA = json;
            render();
            updateStatus('online');
            toast('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ' + DATA.respondents.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'success');
        } else if (json.error) {
            throw new Error(json.error);
        } else {
            updateStatus('online');
            toast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets - ‡πÉ‡∏ä‡πâ Mock Data', '');
            loadMock();
        }
    } catch (error) {
        console.error('Fetch error:', error);
        updateStatus('error');
        toast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets: ' + error.message, 'error');
    }
}

function updateStatus(status) {
    const dot = document.getElementById('statusDot');
    const text = document.getElementById('statusText');
    const update = document.getElementById('lastUpdate');
    
    dot.className = 'status-dot';
    if (status === 'online') {
        dot.classList.add('online');
        text.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß';
    } else if (status === 'loading') {
        dot.classList.add('loading');
        text.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
    } else if (status === 'error') {
        dot.classList.add('error');
        text.textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
    } else {
        text.textContent = 'Ready';
    }
    update.textContent = '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó: ' + new Date().toLocaleTimeString('th-TH');
}

// ===== HELPERS =====
function getFiltered(){
    const t=document.getElementById('teamFilter').value;
    const s=document.getElementById('searchInput').value.toLowerCase();
    return DATA.respondents.filter(r=>{
        const teamMatch = t==='all' || r.team===t;
        const searchMatch = !s || 
            (r.name && r.name.toLowerCase().includes(s)) || 
            (r.department && r.department.toLowerCase().includes(s)) || 
            (r.ideas && r.ideas.toLowerCase().includes(s)) ||
            (r.teamOtherName && r.teamOtherName.toLowerCase().includes(s));
        return teamMatch && searchMatch;
    });
}
function countBy(arr,key){const c={};arr.forEach(i=>{const v=typeof key==='function'?key(i):i[key];if(v!==undefined && v!==null)c[v]=(c[v]||0)+1});return c;}
function flatCount(arr,key){const c={};arr.forEach(i=>{const items=i[key];if(Array.isArray(items)){items.forEach(v=>{if(v)c[v]=(c[v]||0)+1})}});return c;}
function avg(arr,key){if(!arr.length)return 0;return arr.reduce((s,i)=>s+(typeof key==='function'?key(i):(i[key]||0)),0)/arr.length;}
function sortObj(obj){return Object.entries(obj).sort((a,b)=>b[1]-a[1]);}
function toast(msg,type=''){const t=document.getElementById('toast');t.textContent=msg;t.className='toast show '+(type||'');setTimeout(()=>t.classList.remove('show'),3000);}

// ===== RENDER =====
function render(){
const d=getFiltered();
const trans=d.filter(r=>r.team==='transformers');
const green=d.filter(r=>r.team==='green');
const other=d.filter(r=>r.team==='other');

// Header stats
document.getElementById('totalCount').textContent=d.length;
document.getElementById('transCount').textContent=trans.length;
document.getElementById('greenCount').textContent=green.length;
document.getElementById('otherCount').textContent=other.length;

// KPIs
const avgLvl=avg(d,r=>r.readinessLevel||0).toFixed(1);
document.getElementById('kpiLevel').textContent=avgLvl;
const lvlCounts=countBy(d,'readinessLevel');
document.getElementById('kpiLevelHint').textContent=sortObj(lvlCounts).slice(0,2).map(x=>'L'+x[0]).join('-')||'-';
const dailyPct=d.length?Math.round((d.filter(r=>r.usageFrequency==='daily').length/d.length)*100):0;
document.getElementById('kpiDaily').textContent=dailyPct+'%';
const tools=flatCount(d,'toolsUsed');
const topTool=sortObj(tools)[0];
document.getElementById('kpiTool').textContent=topTool?topTool[0]:'N/A';
document.getElementById('kpiToolPct').textContent=topTool?Math.round(topTool[1]/d.length*100)+'%':'-';
const problems=flatCount(d,'problems');
document.getElementById('kpiPain').textContent=Object.keys(problems).length;
const expectKeys=['reduceRepeat','increaseEfficiency','fasterAccess','betterTeamwork','applyImmediately','learnNewTech','prepareFuture','createInnovation'];
const avgExp=d.length?expectKeys.reduce((s,k)=>s+avg(d,r=>(r.expectationsScore||{})[k]||0),0)/expectKeys.length:0;
document.getElementById('kpiExpect').textContent=avgExp.toFixed(1);

// Card A - Respondent Snapshot
const transDepts=countBy(trans,'department'),greenDepts=countBy(green,'department'),otherDepts=countBy(other,'department');
let snapshotHTML=`<div class="team-col trans"><h5>üîµ Transformers (${trans.length})</h5>${sortObj(transDepts).map(([k,v])=>`<div style="font-size:.75rem;margin-bottom:3px">${k}: <strong>${v}</strong></div>`).join('')||'<div style="color:var(--gray)">-</div>'}</div><div class="team-col green"><h5>üü¢ Green (${green.length})</h5>${sortObj(greenDepts).map(([k,v])=>`<div style="font-size:.75rem;margin-bottom:3px">${k}: <strong>${v}</strong></div>`).join('')||'<div style="color:var(--gray)">-</div>'}</div>`;
if(other.length>0){snapshotHTML+=`<div class="team-col other"><h5>‚ö™ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (${other.length})</h5>${sortObj(otherDepts).map(([k,v])=>`<div style="font-size:.75rem;margin-bottom:3px">${k}: <strong>${v}</strong></div>`).join('')||other.map(r=>`<div style="font-size:.75rem;margin-bottom:3px">${r.teamOtherName||r.name||'-'}</div>`).join('')}</div>`;}
document.getElementById('respondentSnapshot').innerHTML=snapshotHTML;
document.getElementById('respondentSnapshot').style.gridTemplateColumns=other.length>0?'1fr 1fr 1fr':'1fr 1fr';

// Card B1 - Level Distribution
const lvlLabels=['‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÉ‡∏ä‡πâ','‡πÄ‡∏Ñ‡∏¢‡∏•‡∏≠‡∏á','‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö','‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á','‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á','‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç'];
const colors=['#E0E0E0','#FFCDD2','#FFAB91','#FFE082','#A5D6A7','#4CAF50'];
document.getElementById('levelDist').innerHTML=[0,1,2,3,4,5].map(l=>{const cnt=lvlCounts[l]||0,pct=d.length?Math.round(cnt/d.length*100):0;return`<div class="level-item"><div class="level-badge l${l}">L${l}</div><div class="level-info"><div class="level-top"><span>${lvlLabels[l]}</span><span class="level-count">${cnt} (${pct}%)</span></div><div class="level-track"><div class="level-fill" style="width:${pct}%;background:${colors[l]}"></div></div></div></div>`;}).join('');

// Card B2 - Tools
const genAI=['ChatGPT','Claude','Gemini','Copilot','Perplexity'],m365=['Word','Excel','PPT','Teams'],special=['Canva AI','Notion AI','Gamma'];
const toolCnt=flatCount(d,'toolsUsed');
const renderTools=list=>list.map(t=>`<div class="tool-chip">${t}<span class="cnt">${toolCnt[t]||0}</span></div>`).join('');
document.getElementById('toolsAdoption').innerHTML=`<div class="tool-section"><div class="tool-label">Generative AI</div><div class="tool-grid">${renderTools(genAI)}</div></div><div class="tool-section"><div class="tool-label">M365 Copilot</div><div class="tool-grid">${renderTools(m365)}</div></div><div class="tool-section"><div class="tool-label">AI ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</div><div class="tool-grid">${renderTools(special)}</div></div>`;

// Card B3 - Frequency
const freqMap={daily:'‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô','2-3wk':'2-3/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå',weekly:'‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á',monthly:'‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á',never:'‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢'};
const freqCnt=countBy(d,'usageFrequency');
const maxFreq=Math.max(...Object.values(freqCnt),1);
document.getElementById('freqChart').innerHTML=Object.entries(freqMap).map(([k,l])=>{const cnt=freqCnt[k]||0,h=Math.round(cnt/maxFreq*100);return`<div class="freq-wrap"><div class="freq-bar" style="height:${h}px"><span class="freq-val">${cnt}</span></div><div class="freq-lbl">${l}</div></div>`;}).join('');

// Card B4 - Copilot Satisfaction
const copilotUsers=d.filter(r=>r.copilotSatisfaction);
const satTools=[{k:'word',l:'Word'},{k:'excel',l:'Excel'},{k:'ppt',l:'PPT'},{k:'teams',l:'Teams'}];
if(copilotUsers.length){
    const satAvg=k=>avg(copilotUsers,r=>(r.copilotSatisfaction||{})[k]||0);
    document.getElementById('copilotHeat').innerHTML=`<thead><tr><th>Tool</th><th>Avg</th><th>Distribution</th></tr></thead><tbody>${satTools.map(t=>{const a=satAvg(t.k).toFixed(1);const dist=[0,1,2,3,4].map(s=>copilotUsers.filter(r=>(r.copilotSatisfaction||{})[t.k]===s).length);return`<tr><td>${t.l}</td><td><span class="heat h${Math.round(a)}">${a}</span></td><td style="font-size:.65rem">${dist.map((c,i)=>`<span class="heat h${i}" style="margin:0 1px;padding:2px 4px">${c}</span>`).join('')}</td></tr>`;}).join('')}</tbody>`;
}else{
    document.getElementById('copilotHeat').innerHTML='<tr><td colspan="3" style="text-align:center;color:var(--gray)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
}

// Card C - Work Allocation
function topWork(arr){const w={};arr.forEach(r=>(r.workAllocation||[]).forEach(a=>{if(a&&a.activity)w[a.activity]=(w[a.activity]||0)+(a.percent||0)}));return sortObj(w).slice(0,5);}
const transWork=topWork(trans),greenWork=topWork(green);
const maxW=Math.max(...transWork.map(x=>x[1]),...greenWork.map(x=>x[1]),1);
const renderWork=(list,len)=>list.map(([n,p],i)=>`<div class="work-item"><div class="work-rank">${i+1}</div><div class="work-info"><div class="work-name">${n}</div><div class="work-track"><div class="work-fill" style="width:${p/maxW*100}%"></div></div></div><div class="work-pct">${Math.round(p/(len||1))}%</div></div>`).join('');
document.getElementById('workAllocation').innerHTML=`<div class="team-col trans"><h5>üîµ Transformers</h5><div class="work-list">${renderWork(transWork,trans.length)||'-'}</div></div><div class="team-col green"><h5>üü¢ Green</h5><div class="work-list">${renderWork(greenWork,green.length)||'-'}</div></div>`;

// Card D1 - Problems
const problemList=sortObj(flatCount(d,'problems')).slice(0,6);
document.getElementById('problemList').innerHTML=problemList.map(([n,c])=>`<div class="problem-item"><div class="problem-icon">‚ö†Ô∏è</div><div class="problem-name">${n}</div><div class="problem-cnt">${c}</div></div>`).join('')||'<div style="color:var(--gray)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';

// Card D2 - AI Help
const helpThemes=sortObj(flatCount(d,'aiHelpMost')).slice(0,8);
const icons=['ü§ñ','üìä','üìù','üöÄ','üí°','üìà','üîç','‚ú®'];
document.getElementById('aiHelpThemes').innerHTML=helpThemes.map(([n,c],i)=>`<div class="theme-card"><div class="theme-icon">${icons[i%8]}</div><div><div class="theme-name">${n}</div><div class="theme-votes">${c} ‡∏Ñ‡∏ô</div></div></div>`).join('')||'<div style="color:var(--gray)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';

// Card D3 - Features Matrix
const features=sortObj(flatCount(d,'interestedFeatures'));
const matrix=document.getElementById('featureMatrix');
matrix.querySelectorAll('.bubble').forEach(b=>b.remove());
features.slice(0,10).forEach(([n,c],i)=>{
    const impact=0.3+Math.random()*0.4;
    const effort=0.2+Math.random()*0.6;
    const b=document.createElement('div');
    b.className='bubble';
    b.style.left=(effort*90+5)+'%';
    b.style.top=((1-impact)*90+5)+'%';
    b.innerHTML=`${n.substring(0,18)}<span class="v">${c}</span>`;
    matrix.appendChild(b);
});

// Card E1 - Expectations
const expectLabels={reduceRepeat:'‡∏•‡∏î‡∏á‡∏≤‡∏ô‡∏ã‡πâ‡∏≥',increaseEfficiency:'‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û',fasterAccess:'‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',betterTeamwork:'‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡∏°',applyImmediately:'‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ',learnNewTech:'‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÉ‡∏´‡∏°‡πà',prepareFuture:'‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï',createInnovation:'‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°'};
document.getElementById('expectTable').innerHTML=`<thead><tr><th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th></tr></thead><tbody>${Object.entries(expectLabels).map(([k,l])=>{const a=avg(d,r=>(r.expectationsScore||{})[k]||0);return`<tr><td>${l}</td><td><div class="rating-wrap"><div class="rating-bar"><div class="rating-fill" style="width:${a*20}%"></div></div><span class="rating-score">${a.toFixed(1)}</span></div></td></tr>`;}).join('')}</tbody>`;

// Card E2 - Topics
const topics=sortObj(flatCount(d,'interestedTopics')).slice(0,8);
const topicIcons=['üìö','üíª','üéØ','üìà','üîß','üåü','üß†','üöÄ'];
document.getElementById('topicsGrid').innerHTML=topics.map(([n,c],i)=>`<div class="theme-card"><div class="theme-icon">${topicIcons[i%8]}</div><div><div class="theme-name">${n}</div><div class="theme-votes">${c} ‡∏Ñ‡∏ô</div></div></div>`).join('')||'<div style="color:var(--gray)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';

// Card F - Ideas
const ideas=d.filter(r=>r.ideas||r.speakerNotes);
document.getElementById('ideasList').innerHTML=ideas.slice(0,10).map(r=>{
    let badgeClass='trans';
    let badgeText='üîµ Trans';
    if(r.team==='green'){badgeClass='green';badgeText='üü¢ Green';}
    else if(r.team==='other'){badgeClass='other';badgeText='‚ö™ '+(r.teamOtherName||'Other');}
    return`<div class="idea-card"><div class="idea-header"><span class="idea-badge ${badgeClass}">${badgeText}</span><span style="font-size:.65rem;color:var(--gray)">${r.name||'-'}</span></div><div class="idea-text">${r.ideas||''} ${r.speakerNotes?'<em style="color:var(--gray)">['+r.speakerNotes+']</em>':''}</div></div>`;
}).join('')||'<div style="color:var(--gray)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';

// Insights
const insights=[
    `üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avgLvl} (L2-L3 ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î)`,
    `üî• ${dailyPct}% ‡πÉ‡∏ä‡πâ AI ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î`,
    `üõ†Ô∏è ${topTool?topTool[0]:'N/A'} ‡πÄ‡∏õ‡πá‡∏ô Tool ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°`,
    `‚ö†Ô∏è Pain Point ‡∏´‡∏•‡∏±‡∏Å: ${problemList[0]?problemList[0][0]:'‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'}`,
    `üéØ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: ‡∏•‡∏î‡∏á‡∏≤‡∏ô‡∏ã‡πâ‡∏≥ + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û`
];
document.getElementById('insightList').innerHTML=insights.map((ins,i)=>`<div class="insight-item"><span class="insight-icon">${['üìä','üî•','üõ†Ô∏è','‚ö†Ô∏è','üéØ'][i]}</span><span>${ins.substring(2)}</span></div>`).join('');

// Training Recommendations
const recs=[
    {title:'üéì Track 1: ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô AI',items:['‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö L0-L2','Prompt Engineering ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô','Hands-on Workshop','‡πÄ‡∏ô‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ']},
    {title:'üöÄ Track 2: M365 Copilot',items:['‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö L2-L3','Word/Excel/Teams Copilot','‡πÄ‡∏ô‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£','‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥']},
    {title:'üéØ Track 3: AI ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á',items:['‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö L3-L5','AI ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢ / Circular','Business Case & ROI','Advanced Prompt']}
];
document.getElementById('recCards').innerHTML=recs.map(r=>`<div class="rec-card"><h5>${r.title}</h5><ul>${r.items.map(i=>`<li>${i}</li>`).join('')}</ul></div>`).join('');
}

// ===== ACTIONS =====
function resetFilters(){document.getElementById('teamFilter').value='all';document.getElementById('searchInput').value='';render();}
function importData(){
    try{
        const json=document.getElementById('importArea').value;
        if(!json.trim()){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á JSON','error');return;}
        const parsed=JSON.parse(json);
        if(parsed.respondents){DATA=parsed;}
        else if(Array.isArray(parsed)){DATA={respondents:parsed};}
        else{throw new Error('Invalid format');}
        render();
        toast('‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à '+DATA.respondents.length+' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£','success');
    }catch(e){
        toast('JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: '+e.message,'error');
    }
}
function exportData(){
    const json=JSON.stringify(DATA,null,2);
    navigator.clipboard.writeText(json).then(()=>toast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON ‡πÅ‡∏•‡πâ‡∏ß','success')).catch(()=>{
        const blob=new Blob([json],{type:'application/json'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a');
        a.href=url;
        a.download='scg_ai_survey_data.json';
        a.click();
        URL.revokeObjectURL(url);
        toast('‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON ‡πÅ‡∏•‡πâ‡∏ß','success');
    });
}

// ===== INIT =====
document.getElementById('schemaDisplay').textContent=SCHEMA;
render(); // ‡πÅ‡∏™‡∏î‡∏á empty state ‡∏Å‡πà‡∏≠‡∏ô
fetchFromGoogleSheets(); // Auto fetch ‡∏à‡∏≤‡∏Å Google Sheets ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
</script>
</body>
</html>
